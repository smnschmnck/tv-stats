---
import { getRatings } from "../../../../db/redis";
import EpisodeRankingsBase from "./EpisodeRankingsBase.astro";

interface Props {
  imdbId: string | undefined;
}

const { imdbId } = Astro.props;

const ratings = await getRatings(imdbId);

const sortedEpisodes = ratings?.episodes.sort();

const highestRankings = sortedEpisodes?.slice(0, 3) ?? [];
const lowestRankings = sortedEpisodes?.slice(-3) ?? [];
---

<EpisodeRankingsBase
  highestRatings={highestRankings}
  lowestRatings={lowestRankings}
/>
